{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport DataTable from \"../../../components/datatable/Datatable\";\nimport Pagination from \"../../../components/datatable/Pagination.vue\";\nimport { mapState } from \"vuex\";\nimport { http, downloadPdf } from \"../../../service/http_service\";\nexport default {\n  name: \"InterportW_Orders\",\n  title: \"Inter-Port - Work_Orders\",\n  components: {\n    datatable: DataTable,\n    pagination: Pagination\n  },\n\n  data() {\n    let apiUrl = this.$store.state.apiUrl;\n    let sortOrders = {};\n    let columns = [// { label: \"#Sl\", name: \"id\" },\n    {\n      label: \"IML File Ref No.\",\n      name: \"iml_reference_no\"\n    }, {\n      label: \"Survey Firm’s File Ref no.\",\n      name: \"survey_firm_reference_no\"\n    }, {\n      label: \"Vessel Name\",\n      name: \"vessel_name\"\n    }, {\n      label: \"File Opening Date\",\n      name: \"file_opening_date\"\n    }, {\n      label: \"Club’s/Client’s File Ref no.\",\n      name: \"club_file_reference_no\"\n    }, // { label: \"Port Name\", name: \"eta_port_name\" },\n    {\n      label: \"Status\",\n      name: \"status\"\n    }, {\n      label: \"Action\",\n      name: \"action\"\n    }];\n    columns.forEach(column => {\n      sortOrders[column.name] = -1;\n    });\n    return {\n      download_file_url: apiUrl + \"v1/download/file_summery/\",\n      user_Info: JSON.parse(localStorage.getItem(\"user\")),\n      user_reference: JSON.parse(localStorage.getItem(\"user_reference\")),\n      user_role: JSON.parse(localStorage.getItem(\"user_role\")),\n      user_role_id: JSON.parse(localStorage.getItem(\"user_role_id\")),\n      // user_role: \"\",\n      w_orders: [],\n      columns: columns,\n      sortKey: \"id\",\n      sortOrders: sortOrders,\n      perPage: [\"10\", \"20\", \"30\", \"25\", \"50\", \"100\"],\n      tableData: {\n        draw: 0,\n        length: 10,\n        search: \"\",\n        column: 0,\n        dir: \"desc\"\n      },\n      pagination: {\n        last_page: \"\",\n        current_page: 1,\n        total: \"\",\n        last_page_url: \"\",\n        next_page_url: \"\",\n        prev_page_url: \"\",\n        from: \"\",\n        to: \"\"\n      },\n      filterWorkOrderData: {\n        work_order_status: \"\",\n        work_order_id: \"\",\n        start_date: \"\",\n        end_date: \"\"\n      },\n      selected: '',\n      value: 2,\n      styling: {\n        objectcolor: '#ff9633',\n        animationcolor: '#ffffff',\n        animationcolor2: '#17fd3d',\n        objectbg: '#999793',\n        opacity: 80,\n        bgcolor: '#343a40',\n        size: 5,\n        speed: 2,\n        disableScrolling: true\n      },\n      code: ``,\n      flag: false\n    };\n  },\n\n  computed: { ...mapState({\n      message: state => state.w_order.success_message\n    })\n  },\n\n  mounted() {\n    this.getAllW_Orders(); // this.user_role = this.user_Info[\"model_has_role\"][\"roles\"][\"name\"];\n\n    console.log(\"user_role: \" + this.user_role);\n    console.log(\"user_reference: \" + this.user_reference);\n    console.log(\"user_role_id: \" + this.user_role_id);\n    this.flag = true;\n  },\n\n  methods: {\n    loader(loader) {\n      this.selected = loader;\n      this.code = `<loader object=\"${this.styling.objectcolor}\" color1=\"${this.styling.animationcolor}\" color2=\"${this.styling.animationcolor2}\" size=\"${this.styling.size}\" speed=\"${this.styling.speed}\" bg=\"${this.styling.bgcolor}\" objectbg=\"${this.styling.objectbg}\" opacity=\"${this.styling.opacity}\" disableScrolling=\"${this.styling.disableScrolling}\" name=\"${this.selected}\"></loader>`;\n      const body = document.getElementsByTagName(\"html\")[0];\n      body.classList.add(\"overflow-hidden\");\n      setTimeout(() => {\n        this.selected = '';\n        const body = document.getElementsByTagName(\"html\")[0];\n        body.classList.remove(\"overflow-hidden\");\n      }, this.value * 1000);\n    },\n\n    getAllW_Orders() {\n      this.tableData.draw++;\n      let params = new URLSearchParams();\n      params.append(\"page\", this.pagination.current_page);\n      params.append(\"draw\", this.tableData.draw);\n      params.append(\"length\", this.tableData.length);\n      params.append(\"search\", this.tableData.search);\n      params.append(\"column\", this.tableData.column);\n      params.append(\"dir\", this.tableData.dir);\n      params.append(\"work_order_status\", this.filterWorkOrderData.work_order_status);\n      params.append(\"work_order_id\", this.filterWorkOrderData.work_order_id);\n      params.append(\"start_date\", this.filterWorkOrderData.start_date);\n      params.append(\"end_date\", this.filterWorkOrderData.end_date);\n      return http().get(\"v1/work_orders/getData?\" + params).then(response => {\n        this.loader('circular');\n        this.w_orders = response.data.data.data;\n        this.pagination = response.data.data;\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n\n    showImage(img) {\n      let server_Path = this.$store.state.serverPath;\n      return server_Path + \"/storage/uploads/work_orders/image/\" + img;\n    },\n\n    sortBy(key) {\n      this.sortKey = key;\n      this.sortOrders[key] = this.sortOrders[key] * -1;\n      this.tableData.column = this.getIndex(this.columns, \"c_f_name\", key);\n      this.tableData.dir = this.sortOrders[key] === 1 ? \"asc\" : \"desc\";\n      this.getAllW_Orders();\n    },\n\n    getIndex(array, key, value) {\n      return array.findIndex(i => i[key] == value);\n    },\n\n    confirmDelete(work_order_details) {\n      let work_order_id = work_order_details.id;\n      this.$swal.fire({\n        title: \"Are you sure?\",\n        text: \"You won't be able to revert this!\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#3085d6\",\n        cancelButtonColor: \"#d33\",\n        confirmButtonText: \"Yes, delete it!\"\n      }).then(result => {\n        if (result.isConfirmed) {\n          console.log(work_order_id);\n          this.deleteW_Orders(work_order_id);\n        }\n      });\n    },\n\n    fileDownload(id) {\n      let url = this.download_file_url + id;\n      downloadPdf(url);\n    },\n\n    confirmForced(work_order_details) {\n      let work_order_id = work_order_details.id;\n      this.$swal.fire({\n        title: \"Are you sure?\",\n        text: \"You won't be able to recollect this!\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#3085d6\",\n        cancelButtonColor: \"#d33\",\n        confirmButtonText: \"Yes, delete it!\"\n      }).then(result => {\n        if (result.isConfirmed) {\n          console.log(work_order_id);\n          this.deleteForcefullyW_Orders(work_order_id);\n        }\n      });\n    },\n\n    deleteW_Orders: async function (id) {\n      try {\n        await this.$store.dispatch(\"w_order/delete_w_order\", id).then(() => {\n          this.$swal.fire({\n            toast: true,\n            position: \"top-end\",\n            icon: \"success\",\n            title: this.message,\n            showConfirmButton: false,\n            timer: 1500\n          });\n          this.getAllW_Orders();\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    },\n    deleteForcefullyW_Orders: async function (id) {\n      try {\n        return http().post(\"v1/work_orders/forced_close/\" + id).then(() => {\n          this.$swal.fire({\n            toast: true,\n            position: \"top-end\",\n            icon: \"success\",\n            title: this.message,\n            showConfirmButton: false,\n            timer: 1500\n          });\n        }); // this.getAllW_Orders();\n      } catch (e) {\n        console.log(e);\n      }\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmNA;AACA;AAEA;AACA;AACA;EACAA,yBADA;EAEAC,iCAFA;EAIAC;IACAC,oBADA;IAEAC;EAFA,CAJA;;EASAC;IACA;IACA;IACA,eACA;IACA;MAAAC;MAAAN;IAAA,CAFA,EAGA;MAAAM;MAAAN;IAAA,CAHA,EAIA;MAAAM;MAAAN;IAAA,CAJA,EAKA;MAAAM;MAAAN;IAAA,CALA,EAMA;MAAAM;MAAAN;IAAA,CANA,EAOA;IACA;MAAAM;MAAAN;IAAA,CARA,EASA;MAAAM;MAAAN;IAAA,CATA;IAWAO;MACAC;IACA,CAFA;IAIA;MACAC,uDADA;MAEAC,mDAFA;MAGAC,kEAHA;MAIAC,wDAJA;MAKAC,8DALA;MAMA;MACAC,YAPA;MAQAP,gBARA;MASAQ,aATA;MAUAP,sBAVA;MAWAQ,8CAXA;MAYAC;QACAC,OADA;QAEAC,UAFA;QAGAC,UAHA;QAIAC,SAJA;QAKAC;MALA,CAZA;MAmBAlB;QACAmB,aADA;QAEAC,eAFA;QAGAC,SAHA;QAIAC,iBAJA;QAKAC,iBALA;QAMAC,iBANA;QAOAC,QAPA;QAQAC;MARA,CAnBA;MA6BAC;QACAC,qBADA;QAEAC,iBAFA;QAGAC,cAHA;QAIAC;MAJA,CA7BA;MAmCAC,YAnCA;MAoCAC,QApCA;MAqCAC;QACAC,sBADA;QAEAC,yBAFA;QAGAC,0BAHA;QAIAC,mBAJA;QAKAC,WALA;QAMAC,kBANA;QAOAC,OAPA;QAQAC,QARA;QASAC;MATA,CArCA;MAgDAC,QAhDA;MAiDAC;IAjDA;EAmDA,CA9EA;;EAgFAC,YACA;MACAC;IADA;EADA,CAhFA;;EAsFAC;IACA,sBADA,CAEA;;IACAC;IACAA;IACAA;IACA;EACA,CA7FA;;EA+FAC;IACAC;MACA;MACA;MACA;MACAC;MACAC;QACA;QACA;QACAD;MACA,CAJA,EAIA,iBAJA;IAKA,CAXA;;IAaAE;MACA;MACA;MACAC;MACAA;MACAA;MACAA;MACAA;MACAA;MAEAA;MACAA;MACAA;MACAA;MAEA,cACAC,GADA,CACA,kCADA,EAEAC,IAFA,CAEAC;QACA;QACA;QACA;MACA,CANA,EAOAC,KAPA,CAOAC;QACAX;MACA,CATA;IAUA,CAtCA;;IAwCAY;MACA;MACA;IACA,CA3CA;;IA6CAC;MACA;MACA;MACA;MACA;MACA;IACA,CAnDA;;IAqDAC;MACA;IACA,CAvDA;;IAyDAC;MACA;MACA,WACAC,IADA,CACA;QACApE,sBADA;QAEAqE,yCAFA;QAGAC,eAHA;QAIAC,sBAJA;QAKAC,6BALA;QAMAC,yBANA;QAOAC;MAPA,CADA,EAUAd,IAVA,CAUAe;QACA;UACAvB;UACA;QACA;MACA,CAfA;IAgBA,CA3EA;;IA4EAwB;MACA;MACAC;IACA,CA/EA;;IAgFAC;MACA;MACA,WACAV,IADA,CACA;QACApE,sBADA;QAEAqE,4CAFA;QAGAC,eAHA;QAIAC,sBAJA;QAKAC,6BALA;QAMAC,yBANA;QAOAC;MAPA,CADA,EAUAd,IAVA,CAUAe;QACA;UACAvB;UACA;QACA;MACA,CAfA;IAgBA,CAlGA;;IAoGA2B;MACA;QACA;UACA;YACAC,WADA;YAEAC,mBAFA;YAGAX,eAHA;YAIAtE,mBAJA;YAKAkF,wBALA;YAMAC;UANA;UAQA;QACA,CAVA;MAWA,CAZA,CAYA;QACA/B;MACA;IACA,CApHA;IAqHAgC;MACA;QACA,cACAC,IADA,CACA,mCADA,EAEAzB,IAFA,CAEA;UACA;YACAoB,WADA;YAEAC,mBAFA;YAGAX,eAHA;YAIAtE,mBAJA;YAKAkF,wBALA;YAMAC;UANA;QAQA,CAXA,EADA,CAaA;MACA,CAdA,CAcA;QACA/B;MACA;IACA;EAvIA;AA/FA","names":["name","title","components","datatable","pagination","data","label","columns","sortOrders","download_file_url","user_Info","user_reference","user_role","user_role_id","w_orders","sortKey","perPage","tableData","draw","length","search","column","dir","last_page","current_page","total","last_page_url","next_page_url","prev_page_url","from","to","filterWorkOrderData","work_order_status","work_order_id","start_date","end_date","selected","value","styling","objectcolor","animationcolor","animationcolor2","objectbg","opacity","bgcolor","size","speed","disableScrolling","code","flag","computed","message","mounted","console","methods","loader","body","setTimeout","getAllW_Orders","params","get","then","response","catch","error","showImage","sortBy","getIndex","confirmDelete","fire","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","result","fileDownload","downloadPdf","confirmForced","deleteW_Orders","toast","position","showConfirmButton","timer","deleteForcefullyW_Orders","post"],"sourceRoot":"src/views/admin/work_orders","sources":["WorkOrders.vue"],"sourcesContent":["<template>\r\n  <div id=\"work_order\">\r\n    <loader :object=\"styling.objectcolor\"\r\n            :color1=\"styling.animationcolor\"\r\n            :color2=\"styling.animationcolor2\"\r\n            :size=\"styling.size\"\r\n            :speed=\"styling.speed\"\r\n            :bg=\"styling.bgcolor\"\r\n            :objectbg=\"styling.objectbg\"\r\n            :opacity=\"styling.opacity\"\r\n            :name=\"selected\"\r\n            :disableScrolling=\"styling.disableScrolling\"></loader>\r\n    <div class=\"card\">\r\n      <h2>File List</h2>\r\n      <div class=\"flex-container-flex-end\">\r\n        <div class=\"flex-item\">\r\n          <select\r\n            class=\"classic\"\r\n            name=\"work_order_status\"\r\n            id=\"global_select\"\r\n            v-model=\"filterWorkOrderData.work_order_status\"\r\n            @change=\"getAllW_Orders()\"\r\n          >\r\n            <option value=\"\" selected disabled>Select Status</option>\r\n            <option value=\"3\">All Files</option>\r\n            <option value=\"0\">All New Files</option>\r\n            <option value=\"2\">All Ongoing Files</option>\r\n            <option value=\"1\">All Completed Files</option>\r\n          </select>\r\n        </div>\r\n        <div class=\"flex-item\">\r\n          <input type=\"date\" name=\"start_date\" v-model=\"filterWorkOrderData.start_date\" value=\"\" />\r\n        </div>\r\n        <div class=\"flex-item\">\r\n          <input type=\"date\" name=\"end_date\" v-model=\"filterWorkOrderData.end_date\" value=\"\" />\r\n        </div>\r\n        <div class=\"flex-item\">\r\n          <button class=\"btn0\" @click=\"getAllW_Orders()\">Filter</button>\r\n        </div>\r\n        <div class=\"flex-item\" v-if=\"user_role_id < 4\">\r\n          <router-link to=\"add_workorders\">\r\n            <button type=\"button\" class=\"btn\">\r\n              <span class=\"material-icons-sharp add\" style=\"font-size: 11px\">add</span>Add New\r\n            </button>\r\n          </router-link>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- <div class=\"flex-container\" style=\"justify-content: flex-end\">\r\n        <router-link to=\"add_workorders\">\r\n          <button type=\"button\" class=\"add_new\">\r\n            <span class=\"material-icons-sharp add\" style=\"font-size: 11px\"\r\n              >add</span\r\n            >Add New\r\n          </button>\r\n        </router-link>\r\n      </div> -->\r\n\r\n      <div class=\"flex-container mobile-flex-container\">\r\n        <div class=\"flex-item\">\r\n          Show:\r\n          <select\r\n            name=\"cars\"\r\n            class=\"entries_count\"\r\n            id=\"cars\"\r\n            style=\"appearance: auto; height: 68%\"\r\n            v-model=\"tableData.length\"\r\n            @change=\"getAllW_Orders()\"\r\n          >\r\n            <option v-for=\"(records, index) in perPage\" :key=\"index\" :value=\"records\">\r\n              {{ records }}\r\n            </option>\r\n          </select>\r\n          records per page.\r\n        </div>\r\n\r\n        <div class=\"flex-item\">\r\n          <input\r\n            type=\"text\"\r\n            v-model=\"tableData.search\"\r\n            @input=\"getAllW_Orders()\"\r\n            placeholder=\"Search here\"\r\n            class=\"search\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <datatable :columns=\"columns\" :sortKey=\"sortKey\" :sortOrders=\"sortOrders\" @sort=\"sortBy\">\r\n          <tbody>\r\n            <tr v-show=\"w_orders.length\" v-for=\"w_order in w_orders\" :key=\"w_order.id\">\r\n              <!-- <td data-label=\"#Sl\" style=\"text-align: center\">\r\n                {{ w_order.id }}\r\n              </td> -->\r\n              <td data-label=\"IML File Ref No.\" style=\"text-align: center\" v-if=\"w_order.iml_reference_no\">\r\n                {{ w_order.iml_reference_no }}\r\n              </td>\r\n              <td data-label=\"IML File Ref No.\" style=\"text-align: center\" v-else>--</td>\r\n              <td\r\n                data-label=\"Survey Firm’s File Ref no.\"\r\n                style=\"text-align: center\"\r\n                v-if=\"w_order.survey_firm_reference_no\"\r\n              >\r\n                {{ w_order.survey_firm_reference_no }}\r\n              </td>\r\n              <td data-label=\"Survey Firm’s File Ref no.\" style=\"text-align: center\" v-else>--</td>\r\n              <td data-label=\"Vessel Name\" style=\"text-align: center\" v-if=\"w_order.vessel_name\">\r\n                {{ w_order.vessel_name }}\r\n              </td>\r\n              <td data-label=\"Name of the vessel/ship\" style=\"text-align: center\" v-else>--</td>\r\n              <td data-label=\"File opening date\" style=\"text-align: center\" v-if=\"w_order.file_opening_date\">\r\n                {{ w_order.file_opening_date }}<br />\r\n              </td>\r\n              <td data-label=\"File opening date\" style=\"text-align: center\" v-else>--</td>\r\n              <td\r\n                data-label=\"Club’s/Client’s File Ref no.\"\r\n                style=\"text-align: center\"\r\n                v-if=\"w_order.club_file_reference_no\"\r\n              >\r\n                {{ w_order.club_file_reference_no }}\r\n              </td>\r\n              <td data-label=\"Club’s/Client’s File Ref no.\" style=\"text-align: center\" v-else>--</td>\r\n              <!-- <td data-label=\"Port Name\" style=\"text-align: center\">\r\n                {{ w_order.eta_port_name }}\r\n              </td> -->\r\n              <td data-label=\"Status\" style=\"text-align: center\" v-if=\"w_order.status == 0\">\r\n                <p class=\"chips2\">Not Started</p>\r\n              </td>\r\n              <td data-label=\"Status\" style=\"text-align: center\" v-if=\"w_order.status == 2\">\r\n                <p class=\"chips1\">Inprogress</p>\r\n              </td>\r\n              <td data-label=\"Status\" style=\"text-align: center\" v-if=\"w_order.status == 1\">\r\n                <p class=\"chips\">Completed</p>\r\n              </td>\r\n              <td data-label=\"Actions\" style=\"text-align: center\">\r\n                <div class=\"dropdown\">\r\n                  <button class=\"dropbtn\" type=\"button\">\r\n                    <span class=\"material-icons-sharp\"> more_horiz </span>\r\n                  </button>\r\n                  <div class=\"dropdown-content\">\r\n                    <router-link :to=\"`/dashboard/edit_workorders/${w_order.id}`\">\r\n                      <button v-if=\"user_role_id < 4\" title=\"Edit File\" type=\"button\" class=\"actio-button-margin edit\">\r\n                        <span class=\"material-icons-sharp add\" style=\"font-size: 11px\">edit</span>\r\n                        Edit\r\n                      </button>\r\n                    </router-link>\r\n                    <button\r\n                      v-if=\"user_role_id < 4\"\r\n                      title=\"Delete File\"\r\n                      type=\"button\"\r\n                      class=\"actio-button-margin delete\"\r\n                      v-on:click=\"confirmDelete(w_order)\"\r\n                    >\r\n                      <span class=\"material-icons-sharp add\" style=\"font-size: 11px\">delete</span>\r\n                      Delete\r\n                    </button>\r\n                    <!-- <button v-else></button> -->\r\n                    <router-link :to=\"`/dashboard/workorders/details/${w_order.id}`\">\r\n                      <button title=\"Manage File\" type=\"button\" class=\"actio-button-margin add1\">\r\n                        <span class=\"material-icons-sharp add\" style=\"font-size: 11px\">add</span>\r\n                        More\r\n                      </button>\r\n                    </router-link>\r\n                    <router-link :to=\"`/dashboard/workorders_details/${w_order.id}`\">\r\n                      <button title=\"File Details\" type=\"button\" class=\"actio-button-margin survey\">\r\n                        <span class=\"material-icons-sharp add\" style=\"font-size: 11px\">details</span>\r\n                        Details\r\n                      </button>\r\n                    </router-link>\r\n                    <button\r\n                      title=\"Download File\"\r\n                      type=\"button\"\r\n                      class=\"actio-button-margin download\"\r\n                      v-on:click=\"fileDownload( w_order.id)\"\r\n                    >\r\n                    Download\r\n                    </button>\r\n                    <button\r\n                      v-if=\"user_role_id < 4\"\r\n                      title=\"Forced closed\"\r\n                      type=\"button\"\r\n                      class=\"actio-button-margin close\"\r\n                      v-on:click=\"confirmForced(w_order)\"\r\n                    >\r\n                      <span class=\"material-icons-sharp\" style=\"font-size: 11px\">close</span>Close\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n            <tr v-show=\"!w_orders.length\">\r\n              <td colspan=\"8\">No Data Found</td>\r\n            </tr>\r\n          </tbody>\r\n        </datatable>\r\n      </div>\r\n      <div class=\"mobile-pagination\">\r\n        <div class=\"flex-container-pagination\" style=\"padding-right: 10px\">\r\n          <div class=\"flex-item\">\r\n            Showing {{ pagination.from }} to {{ pagination.to }} of {{ pagination.total }} records\r\n          </div>\r\n          <div style=\"display: flex; justify-content: flex-end\">\r\n            <pagination :pagination.sync=\"pagination\" :offset=\"5\" @paginate=\"getAllW_Orders()\"></pagination>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport DataTable from \"../../../components/datatable/Datatable\";\r\nimport Pagination from \"../../../components/datatable/Pagination.vue\";\r\n\r\nimport { mapState } from \"vuex\";\r\nimport { http, downloadPdf } from \"../../../service/http_service\";\r\nexport default {\r\n  name: \"InterportW_Orders\",\r\n  title: \"Inter-Port - Work_Orders\",\r\n\r\n  components: {\r\n    datatable: DataTable,\r\n    pagination: Pagination,\r\n  },\r\n\r\n  data() {\r\n    let apiUrl = this.$store.state.apiUrl;\r\n    let sortOrders = {};\r\n    let columns = [\r\n      // { label: \"#Sl\", name: \"id\" },\r\n      { label: \"IML File Ref No.\", name: \"iml_reference_no\" },\r\n      { label: \"Survey Firm’s File Ref no.\", name: \"survey_firm_reference_no\" },\r\n      { label: \"Vessel Name\", name: \"vessel_name\" },\r\n      { label: \"File Opening Date\", name: \"file_opening_date\" },\r\n      { label: \"Club’s/Client’s File Ref no.\", name: \"club_file_reference_no\" },\r\n      // { label: \"Port Name\", name: \"eta_port_name\" },\r\n      { label: \"Status\", name: \"status\" },\r\n      { label: \"Action\", name: \"action\" },\r\n    ];\r\n    columns.forEach((column) => {\r\n      sortOrders[column.name] = -1;\r\n    });\r\n\r\n    return {\r\n      download_file_url: apiUrl + \"v1/download/file_summery/\",\r\n      user_Info: JSON.parse(localStorage.getItem(\"user\")),\r\n      user_reference: JSON.parse(localStorage.getItem(\"user_reference\")),\r\n      user_role: JSON.parse(localStorage.getItem(\"user_role\")),\r\n      user_role_id: JSON.parse(localStorage.getItem(\"user_role_id\")),\r\n      // user_role: \"\",\r\n      w_orders: [],\r\n      columns: columns,\r\n      sortKey: \"id\",\r\n      sortOrders: sortOrders,\r\n      perPage: [\"10\", \"20\", \"30\", \"25\", \"50\", \"100\"],\r\n      tableData: {\r\n        draw: 0,\r\n        length: 10,\r\n        search: \"\",\r\n        column: 0,\r\n        dir: \"desc\",\r\n      },\r\n      pagination: {\r\n        last_page: \"\",\r\n        current_page: 1,\r\n        total: \"\",\r\n        last_page_url: \"\",\r\n        next_page_url: \"\",\r\n        prev_page_url: \"\",\r\n        from: \"\",\r\n        to: \"\",\r\n      },\r\n      filterWorkOrderData: {\r\n        work_order_status: \"\",\r\n        work_order_id: \"\",\r\n        start_date: \"\",\r\n        end_date: \"\",\r\n      },\r\n      selected: '',\r\n      value: 2,\r\n      styling: {\r\n        objectcolor: '#ff9633',\r\n        animationcolor: '#ffffff',\r\n        animationcolor2: '#17fd3d',\r\n        objectbg: '#999793',\r\n        opacity: 80,\r\n        bgcolor: '#343a40',\r\n        size: 5,\r\n        speed: 2,\r\n        disableScrolling: true,\r\n      },\r\n      code: ``,\r\n      flag: false\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    ...mapState({\r\n      message: (state) => state.w_order.success_message,\r\n    }),\r\n  },\r\n\r\n  mounted() {\r\n    this.getAllW_Orders();\r\n    // this.user_role = this.user_Info[\"model_has_role\"][\"roles\"][\"name\"];\r\n    console.log(\"user_role: \" + this.user_role);\r\n    console.log(\"user_reference: \" + this.user_reference);\r\n    console.log(\"user_role_id: \" + this.user_role_id);\r\n    this.flag=true;\r\n  },\r\n\r\n  methods: {\r\n    loader(loader) {\r\n      this.selected=loader;\r\n      this.code=`<loader object=\"${this.styling.objectcolor}\" color1=\"${this.styling.animationcolor}\" color2=\"${this.styling.animationcolor2}\" size=\"${this.styling.size}\" speed=\"${this.styling.speed}\" bg=\"${this.styling.bgcolor}\" objectbg=\"${this.styling.objectbg}\" opacity=\"${this.styling.opacity}\" disableScrolling=\"${this.styling.disableScrolling}\" name=\"${this.selected}\"></loader>`\r\n      const body = document.getElementsByTagName(\"html\")[0];\r\n      body.classList.add(\"overflow-hidden\");\r\n      setTimeout(() => {\r\n        this.selected='';\r\n        const body = document.getElementsByTagName(\"html\")[0];\r\n        body.classList.remove(\"overflow-hidden\");\r\n      }, this.value*1000);\r\n    },\r\n\r\n    getAllW_Orders() {\r\n      this.tableData.draw++;\r\n      let params = new URLSearchParams();\r\n      params.append(\"page\", this.pagination.current_page);\r\n      params.append(\"draw\", this.tableData.draw);\r\n      params.append(\"length\", this.tableData.length);\r\n      params.append(\"search\", this.tableData.search);\r\n      params.append(\"column\", this.tableData.column);\r\n      params.append(\"dir\", this.tableData.dir);\r\n\r\n      params.append(\"work_order_status\", this.filterWorkOrderData.work_order_status);\r\n      params.append(\"work_order_id\", this.filterWorkOrderData.work_order_id);\r\n      params.append(\"start_date\", this.filterWorkOrderData.start_date);\r\n      params.append(\"end_date\", this.filterWorkOrderData.end_date);\r\n\r\n      return http()\r\n        .get(\"v1/work_orders/getData?\" + params)\r\n        .then((response) => {\r\n          this.loader('circular');\r\n          this.w_orders = response.data.data.data;\r\n          this.pagination = response.data.data;\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n        });\r\n    },\r\n\r\n    showImage(img) {\r\n      let server_Path = this.$store.state.serverPath;\r\n      return server_Path + \"/storage/uploads/work_orders/image/\" + img;\r\n    },\r\n\r\n    sortBy(key) {\r\n      this.sortKey = key;\r\n      this.sortOrders[key] = this.sortOrders[key] * -1;\r\n      this.tableData.column = this.getIndex(this.columns, \"c_f_name\", key);\r\n      this.tableData.dir = this.sortOrders[key] === 1 ? \"asc\" : \"desc\";\r\n      this.getAllW_Orders();\r\n    },\r\n\r\n    getIndex(array, key, value) {\r\n      return array.findIndex((i) => i[key] == value);\r\n    },\r\n\r\n    confirmDelete(work_order_details) {\r\n      let work_order_id = work_order_details.id;\r\n      this.$swal\r\n        .fire({\r\n          title: \"Are you sure?\",\r\n          text: \"You won't be able to revert this!\",\r\n          icon: \"warning\",\r\n          showCancelButton: true,\r\n          confirmButtonColor: \"#3085d6\",\r\n          cancelButtonColor: \"#d33\",\r\n          confirmButtonText: \"Yes, delete it!\",\r\n        })\r\n        .then((result) => {\r\n          if (result.isConfirmed) {\r\n            console.log(work_order_id);\r\n            this.deleteW_Orders(work_order_id);\r\n          }\r\n        });\r\n    },\r\n    fileDownload(id) {\r\n      let url = this.download_file_url + id;\r\n      downloadPdf(url);\r\n    },\r\n    confirmForced(work_order_details) {\r\n      let work_order_id = work_order_details.id;\r\n      this.$swal\r\n        .fire({\r\n          title: \"Are you sure?\",\r\n          text: \"You won't be able to recollect this!\",\r\n          icon: \"warning\",\r\n          showCancelButton: true,\r\n          confirmButtonColor: \"#3085d6\",\r\n          cancelButtonColor: \"#d33\",\r\n          confirmButtonText: \"Yes, delete it!\",\r\n        })\r\n        .then((result) => {\r\n          if (result.isConfirmed) {\r\n            console.log(work_order_id);\r\n            this.deleteForcefullyW_Orders(work_order_id);\r\n          }\r\n        });\r\n    },\r\n\r\n    deleteW_Orders: async function (id) {\r\n      try {\r\n        await this.$store.dispatch(\"w_order/delete_w_order\", id).then(() => {\r\n          this.$swal.fire({\r\n            toast: true,\r\n            position: \"top-end\",\r\n            icon: \"success\",\r\n            title: this.message,\r\n            showConfirmButton: false,\r\n            timer: 1500,\r\n          });\r\n          this.getAllW_Orders();\r\n        });\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    },\r\n    deleteForcefullyW_Orders: async function (id) {\r\n      try {\r\n        return http()\r\n          .post(\"v1/work_orders/forced_close/\" + id)\r\n          .then(() => {\r\n            this.$swal.fire({\r\n              toast: true,\r\n              position: \"top-end\",\r\n              icon: \"success\",\r\n              title: this.message,\r\n              showConfirmButton: false,\r\n              timer: 1500,\r\n            });\r\n          });\r\n        // this.getAllW_Orders();\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n#work_order {\r\n  padding: 0px 5px 0px 5px;\r\n  margin: 0px 15px 0px 15px;\r\n}\r\n/* Chrome, Safari, Edge, Opera */\r\ninput::-webkit-outer-spin-button,\r\ninput::-webkit-inner-spin-button {\r\n  -webkit-appearance: none;\r\n  margin: 0;\r\n}\r\n\r\n/* Firefox */\r\ninput[type=\"number\"] {\r\n  -moz-appearance: textfield;\r\n}\r\n\r\n\r\n\r\n#surveyor_id {\r\n  border: 1px solid #aaa !important;\r\n  border-radius: 3px !important;\r\n  background-color: transparent !important;\r\n  padding: 14px !important;\r\n}\r\n.card {\r\n  background-color: #fff;\r\n  padding: 15px;\r\n  border-radius: 10px;\r\n  box-shadow: #f1f1f1;\r\n  margin-top: 25px;\r\n}\r\n\r\n.survey {\r\n  background-color: rgb(102 102 229);\r\n}\r\n.add1 {\r\n  background-color: rgb(68 192 81);\r\n}\r\n\r\nbutton {\r\n  padding: 5px 5px;\r\n  border-radius: 5px;\r\n  color: #fff;\r\n  outline: none;\r\n  border: none;\r\n  cursor: pointer;\r\n}\r\nbutton:hover {\r\n  background-color: #2185d0;\r\n}\r\n.chips {\r\n  width: 56%;\r\n  margin-top: 5px;\r\n  margin-left: 31px;\r\n  margin-right: 24px;\r\n}\r\n.chips1 {\r\n  width: 56%;\r\n  margin-top: 5px;\r\n  margin-left: 31px;\r\n  margin-right: 24px;\r\n}\r\n.chips2 {\r\n  width: 56%;\r\n  margin-top: 5px;\r\n  margin-left: 31px;\r\n  margin-right: 24px;\r\n}\r\nth,\r\ntd {\r\n  padding: 21px;\r\n}\r\n.close {\r\n  color: rgb(255, 255, 255);\r\n  background-color: rgb(157, 61, 61);\r\n}\r\n.btn0 {\r\n  height: 42px;\r\n  width: 100px;\r\n  background-color: rgb(154 205 89 / 91%);\r\n  font-size: 16px;\r\n  margin-left: 8%;\r\n  color: rgb(238 239 240);\r\n  font-weight: 600;\r\n}\r\n.btn0:hover {\r\n  background-color: rgba(126, 184, 51, 0.91);\r\n}\r\n.btn:hover {\r\n  background-color:  #008CBA;\r\n}\r\n.btn {\r\n  height: 41px;\r\n  width: 100px;\r\n  background-color: #1367A2;\r\n  margin-right: 0%;\r\n  color: rgb(238 239 240);\r\n  font-weight: 600;\r\n}\r\n/* Dropdown Button */\r\n.dropbtn {\r\n  background-color: #f7f5f5;\r\n  color: #020202;\r\n  padding: 5px;\r\n  font-size: 16px;\r\n  border: none;\r\n}\r\n\r\n/* The container <div> - needed to position the dropdown content */\r\n.dropdown {\r\n  position: relative;\r\n}\r\n\r\n/* Dropdown Content (Hidden by Default) */\r\n.dropdown-content {\r\n  display: none;\r\n  position: absolute;\r\n  background-color: #f1f1f1;\r\n  min-width: 100px;\r\n  box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);\r\n  z-index: 1;\r\n  border-radius: 10px;\r\n}\r\n\r\n.dropdown-content button {\r\n  margin: 5px 4px 5px 8px;\r\n  width: 70%;\r\n}\r\n\r\n.active {\r\n  opacity: 2;\r\n  pointer-events: visible;\r\n  top: 100%;\r\n  display: none;\r\n  z-index: 1;\r\n}\r\n\r\n/* Show the dropdown menu on hover */\r\n.dropdown:hover .dropdown-content {\r\n  display: block;\r\n}\r\n\r\n/* Change the background color of the dropdown button when the dropdown content is shown */\r\n.dropdown:hover .dropbtn {\r\n  background-color: #3e8e41;\r\n}\r\n/* .dropdown-content button {\r\n  width:70%\r\n} */\r\ninput[type=\"date\"] {\r\n  width: 110%;\r\n  height: 41px;\r\n}\r\ninput[type=\"text\"] {\r\n  width: 104%;\r\n  /* height: 44px; */\r\n}\r\n\r\nh1 {\r\n  font-size: 1.3rem;\r\n}\r\n.download{\r\n  background-color: #349437;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}